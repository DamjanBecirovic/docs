- [About Pipeline YAML](#pipeline-yaml-reference)

  * [The preamble](#the-preamble)
  * [Constants](#constants)
  * [List of properties](#list-of-properties)
  * [Examples](#complete-examples)
  * [Preamble example](#preamble-example)
  * [See also](#see-also)
 

# Pipeline YAML Reference

This document is the reference for the YAML grammar used for describing the pipelines of Semaphore 2.0.

# Comments

Lines that begin with # are considered comments and are being ignored by the YALM parser, which is not a Semaphore 2.0 feature but the way YAML files work.


# The preamble
Each Semaphore 2.0 pipeline configuration file has a preamble, which is
mandatory and should be present on every `.semaphore/semaphore.yml` file you create.


## Constants

### The e1-standard-2 constant

The `e1-standard-2` value used in the preamble represents the hardware of the Virtual Machine used for each job in the current pipeline and is a global variable.


### The ubuntu1804 constant

The `ubuntu1804` value used in the preamble represents the Operating System of the Virtual Machine used for each job in the current pipeline and is a global variable.



# List of Properties



## version

The `version` property is a string value that shows the version of the
pipeline YAML file that will be used.

List of valid values: `"v1.0"`

Example: `version: "v1.0"`

## name

The `name` property is a Unicode string that assigns a name to the Semaphore 2.0 project.

*Caution*: The `name` property can be found in other sections because it is used
for defining the name of a job inside a `jobs` block or the name of
a `task` section defined using `task`.

Example: `name: "The name of the Semaphore 2.0 project"`


## agent

The `agent` property requires three additional properties that identify the
environment (type of container) in which the jobs of the pipeline will get executed.

Example:

    agent:
      machine:
        type: e1-standard-2
        os_image: ubuntu1804
    blocks:


### machine

The `machine` property, which can only be found under `agent`, holds the `type` and `os_image` properties.

Example:

    machine:
      type: e1-standard-2
      os_image: ubuntu1804


### type

The `type` property is intended for selecting the machine
(hardware) you would like to use for your builds.

List of valid values: `e1-standard-2`

Example: `type = e1-standard-2`


### os_image

The `os_image` property specifies the operating system and the version of the operation systems that will be used.


Valid values: `ubuntu1804`


Example: `os_image = ubuntu1804`


## blocks

The values of the `blocks` property are the tasks of a pipeline as defined by the `task` property.

## Preamble example

    version: "v1.0"
    name: "The name of the Semaphore 2.0 project"
    agent:
      machine:
        type: e1-standard-2
        os_image: ubuntu1804
    blocks:



# Complete examples



##  A complete .semaphore/semaphore.yml example

The following code presents a complete `.semaphore/semaphore.yml` file:

    version: "v1.0"
    name: YAML file example for Go project.
    agent:
      machine:
        type: e1-standard-2
        os_image: ubuntu1804
    blocks:
     - name: Inspect Linux environment
       task:
          jobs:
            - name: Execute hw.go
              commands:
                - echo $SEMAPHORE_PIPELINE_ID
                - echo $HOME
                - echo $SEMAPHORE_GIT_DIR
                - pwd
                - ls -al
                - cat hw.go
                - echo $VAR1
                - echo $PI
          prologue:
              commands:
                - checkout
          env_vars:
               - name: VAR1
                 value: Environment Variable 1
               - name: PI
                 value: "3.14159"

     - name: Calling text file
       task:
          jobs:
            - name: Using command_file
              cmd_file: command_file
          prologue:
              commands:
                - checkout

     - name: Build Go project
       task:
          jobs:
            - name: Build hw.go
              commands:
                - checkout
                - sudo apt-get -y install golang-go
                - go build hw.go
                - ls -l ./hw
                - file ./hw
                - ./hw
            - name: PATH variable
              commands:
                - echo $PATH
          epilogue:
              commands:
                - echo $SEMAPHORE_JOB_RESULT
                - echo $SEMAPHORE_PIPELINE_ID


## A .semaphore/semaphore.yml file without name properties

Although it is allowed to have `.semaphore/semaphore.yml` files without
name properties, it is considered a very bad practice and should be
avoided.

However, the following sample `.semaphore/semaphore.yml` file proves
that it can be done:

    version: "v1.0"
    name: Basic YAML configuration file example.
    semaphore_image: standard
    blocks:
      - task:
          jobs:
              - commands:
                 - echo $SEMAPHORE_PIPELINE_ID
                 - echo "Hello World!"

## See also

